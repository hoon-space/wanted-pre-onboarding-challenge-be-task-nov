# DB Table 동시 접근에 대한 방안

## 1. 문제 상황

---
동시에 같은 DB Table row를 업데이트하는 상황  

우선 이 문제 상황을 2개 이상의 트랜잭션이 동시에 같은 데이터를 조회가 아닌 수정을 한다는 상황으로 해석했다.  

## 2. 방안책

---
### 2.1 접근
해당 데이터가 왜 동시 수정되는 상황이 발생하는지를 알아볼 것 같다.  
운영중인 서비스가 동시에 많은 수정이 발생하는 것인지 아니면 의도와 다르게 그렇지 않지만 실수로 해당 상황이 발생했는지 말이다.  
동시에 많은 수정은 예를 들어 '좋아요 기능'이 될 수 있고 그렇지 않은 경우는 '게시글 수정'이 될 수 있다.

### 2.2 동시 접근을 허용하는 기능에 대한 방안
크게 2가지가 있다.  

첫 번째는 '낙관적 락'을 제공하는 것이다.  
이를 통해 일부 트랜잭션은 실패할 수도 있게 설계를 한다.  

두 번째는 '비관적 락'이다.
이는 트랜잭션의 실패를 허용하지 않게 하지만 동시에 많은 트랜잭션 요청시 성능 저하 문제를 야기할 수 있다.  
그리고 이때 베타락을 통해 관리해야 한다.  

### 2.3 동시 접근을 허용하지 않을 때 방안
만약 두 개의 환경에서 같은 글을 수정하는 행위는 정상적인 상황이 아닐 수 있다.  
따라서 이런 상황에 대해 로그인 같은 사용자 인증에 대한 관리가 필요하다.

예를 들어, 사용자 인증은 동시에 하나의 기기에서만 가능하게 하는 것이다.