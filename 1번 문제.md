# (1) 동시에 같은 DB Table row 를 업데이트 하는 상황을 방어하기 위해 어떻게 개발하실 건지 설명해주세요.

동시에 같은 DB Table row를 업데이트 하는 상황에서 락(Lock)을 사용하여 동시성을 제어할 수 있다. 락에는 비관적 락(Pessimistic Lock)과 낙관적 락(Optimistic Lock)이 있다.

### 비관적 락 (Pessimistic Lock)
데이터의 무결성이 중요하고 데이터 충돌이 많이 발생하는 경우 비관적 락을 사용한다. 비관적 락은 트랜잭션이 시작될 때 Shared Lock 또는 Exclusive Lock을 걸고 시작하는 방법이다. Shared Lock을 걸면 write 하기 위해 Exclusive Lock을 얻어야하는데 Shared Lock이 다른 트랜잭션에 걸려 있으면 해당 Lock을 얻지 못해 업데이트가 불가능하다. 해당 트랜잭션을 제외한 모든 트랜잭션이 종료가 되어야 수정이 가능하다. 위와 같이 비관적 락을 사용하여 충돌을 예방할 수 있다.


### 낙관적 락 (Optimistic Lock)
데이터 충돌이 자주 일어나지 않을 것으로 예상되고 조회 작업이 많아 동시 접근 성능이 중요할 때 낙관적 락을 사용한다. 낙관적 락은 row를 업데이트 할 때, 수정했다고 명시하여 다른 사람이 동일한 조건으로 값을 수정할 수 없게 하는 것이다. version과 같은 별도의 컬럼을 추가하여 충돌 발생을 막는다. 충돌이 발생했을 때, DB가 아닌 Application Level에서 처리한다. 여러 작업이 묶인 트랜잭션 요청이 실패할 경우, 개발자가 직접 롤백 처리를 한다.
